name: Full CI for PR

# Manual trigger for comprehensive PR testing
on:
  workflow_dispatch:
  pull_request:
    types: [labeled]

jobs:
  trigger-full-ci:
    name: Trigger Full CI
    # Only run if labeled with 'ci:full' or manually triggered
    if: |
      github.event_name == 'workflow_dispatch' ||
      (github.event_name == 'pull_request' && contains(github.event.pull_request.labels.*.name, 'ci:full'))
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Message
        run: |
          echo "ðŸš€ Running FULL CI suite for this PR"
          echo "This includes stress tests, performance, and security scans"
          echo "This may take 20-30 minutes to complete"
      
      - uses: actions/checkout@v6
      
      # Re-run ci.yml but override the conditions
      - name: Trigger Full Test Suite
        uses: actions/github-script@v8
        with:
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'ci.yml',
              ref: context.ref,
              inputs: {
                force_full_run: 'true'
              }
            });